name: Sync to Gitee

on:
  push:
    branches:
      - main # 监听 main 分支的 push 事件，如果你的主分支是 master，请改为 master

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0 # 获取所有历史，很重要

      - name: Set up Git
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"

      - name: Set up SSH
        uses: webfactory/ssh-agent@v0.8.0
        with:
          ssh-private-key: ${{ secrets.GITEE_PRIVATE_KEY }}

      - name: Add Gitee remote
        run: git remote add gitee git@gitee.com:zejunxu/mosdns-bak.git

      - name: Push to Gitee
        run: git push --force gitee main # 将你的 GitHub 仓库的 main 分支强制推送到 Gitee
